Downloading: "https://download.pytorch.org/models/vgg16-397923af.pth" to /home/nsml/.cache/torch/checkpoints/vgg16-397923af.pth

  0%|          | 0.00/528M [00:00<?, ?B/s]
  1%|▏         | 7.69M/528M [00:00<00:06, 79.0MB/s]
  2%|▏         | 11.6M/528M [00:00<00:10, 51.9MB/s]
  4%|▎         | 18.7M/528M [00:00<00:09, 57.0MB/s]
  4%|▍         | 22.7M/528M [00:00<00:10, 50.3MB/s]
  5%|▌         | 28.8M/528M [00:00<00:09, 53.6MB/s]
  6%|▋         | 33.3M/528M [00:00<00:10, 50.4MB/s]
  8%|▊         | 41.0M/528M [00:00<00:08, 56.7MB/s]
  9%|▉         | 49.7M/528M [00:00<00:07, 64.0MB/s]
 11%|█         | 56.0M/528M [00:00<00:08, 61.4MB/s]
 12%|█▏        | 62.8M/528M [00:01<00:07, 63.7MB/s]
 13%|█▎        | 69.1M/528M [00:01<00:09, 50.9MB/s]
 14%|█▍        | 75.8M/528M [00:01<00:08, 55.5MB/s]
 15%|█▌        | 81.6M/528M [00:01<00:08, 54.3MB/s]
 16%|█▋        | 87.1M/528M [00:01<00:08, 55.2MB/s]
 18%|█▊        | 95.2M/528M [00:01<00:07, 61.8MB/s]
 20%|█▉        | 104M/528M [00:01<00:06, 68.0MB/s] 
 21%|██▏       | 113M/528M [00:01<00:05, 74.2MB/s]
 23%|██▎       | 122M/528M [00:01<00:05, 78.7MB/s]
 25%|██▍       | 130M/528M [00:02<00:05, 77.2MB/s]
 26%|██▌       | 137M/528M [00:02<00:06, 61.7MB/s]
 27%|██▋       | 144M/528M [00:02<00:06, 63.3MB/s]
 29%|██▉       | 152M/528M [00:02<00:05, 65.9MB/s]
 30%|███       | 158M/528M [00:02<00:07, 55.0MB/s]
 31%|███       | 165M/528M [00:02<00:06, 57.7MB/s]
 33%|███▎      | 173M/528M [00:02<00:05, 65.1MB/s]
 34%|███▍      | 180M/528M [00:03<00:05, 60.8MB/s]
 36%|███▌      | 188M/528M [00:03<00:05, 66.5MB/s]
 37%|███▋      | 197M/528M [00:03<00:04, 72.3MB/s]
 39%|███▊      | 204M/528M [00:03<00:05, 67.7MB/s]
 40%|████      | 212M/528M [00:03<00:04, 68.7MB/s]
 42%|████▏     | 219M/528M [00:03<00:04, 68.7MB/s]
 43%|████▎     | 226M/528M [00:03<00:04, 68.4MB/s]
 44%|████▍     | 234M/528M [00:03<00:04, 72.1MB/s]
 46%|████▌     | 241M/528M [00:03<00:04, 70.9MB/s]
 47%|████▋     | 248M/528M [00:03<00:04, 72.3MB/s]
 49%|████▊     | 256M/528M [00:04<00:03, 75.0MB/s]
 50%|█████     | 264M/528M [00:04<00:03, 78.7MB/s]
 52%|█████▏    | 272M/528M [00:04<00:03, 71.5MB/s]
 53%|█████▎    | 279M/528M [00:04<00:03, 66.6MB/s]
 54%|█████▍    | 287M/528M [00:04<00:03, 71.6MB/s]
 56%|█████▋    | 297M/528M [00:04<00:03, 78.4MB/s]
 58%|█████▊    | 307M/528M [00:04<00:02, 84.2MB/s]
 60%|█████▉    | 315M/528M [00:04<00:02, 85.1MB/s]
 61%|██████▏   | 324M/528M [00:04<00:02, 80.9MB/s]
 63%|██████▎   | 332M/528M [00:05<00:02, 82.0MB/s]
 64%|██████▍   | 340M/528M [00:05<00:02, 81.7MB/s]
 66%|██████▌   | 349M/528M [00:05<00:02, 86.0MB/s]
 68%|██████▊   | 358M/528M [00:05<00:02, 88.5MB/s]
 70%|██████▉   | 367M/528M [00:05<00:01, 89.8MB/s]
 71%|███████   | 376M/528M [00:05<00:01, 85.3MB/s]
 73%|███████▎  | 384M/528M [00:05<00:01, 80.0MB/s]
 74%|███████▍  | 392M/528M [00:05<00:01, 80.9MB/s]
 76%|███████▌  | 401M/528M [00:05<00:01, 84.9MB/s]
 78%|███████▊  | 409M/528M [00:06<00:01, 81.6MB/s]
 79%|███████▉  | 417M/528M [00:06<00:01, 73.7MB/s]
 81%|████████  | 427M/528M [00:06<00:01, 79.7MB/s]
 82%|████████▏ | 435M/528M [00:06<00:01, 74.2MB/s]
 84%|████████▍ | 444M/528M [00:06<00:01, 79.5MB/s]
 86%|████████▌ | 452M/528M [00:06<00:01, 79.0MB/s]
 87%|████████▋ | 460M/528M [00:06<00:00, 80.0MB/s]
 89%|████████▉ | 469M/528M [00:06<00:00, 84.4MB/s]
 90%|█████████ | 477M/528M [00:06<00:00, 76.8MB/s]
 92%|█████████▏| 485M/528M [00:07<00:00, 75.9MB/s]
 93%|█████████▎| 492M/528M [00:07<00:00, 65.6MB/s]
 94%|█████████▍| 499M/528M [00:07<00:00, 66.2MB/s]
 96%|█████████▌| 505M/528M [00:07<00:00, 66.5MB/s]
 98%|█████████▊| 515M/528M [00:07<00:00, 74.3MB/s]
 99%|█████████▉| 523M/528M [00:07<00:00, 76.5MB/s]
100%|██████████| 528M/528M [00:07<00:00, 72.1MB/s]
VGG16 Loaded!
before fit
Trying out 384 number of hyperparameter combinations!
{'batch_size': 128,
 'class_ratio': [0.5, 0.1, 0.15, 0.4],
 'epoch': [5, 10],
 'gamma': 0.3,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1.0000, 1.0000, 1.0000, 1.1000]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1, None],
 'val_ratio': [0.012, 0.25, 0.2, 0.2],
 'weight_decay': 0}
Dataloader constructed! 
	 Train size = 75597 	Validation size = 2081
	 Validation dataset composition  [35, 7, 12, 44]
	 Training dataset composition  [32869, 6573, 9860, 26295]
	 Training dataset proportion  [43, 8, 13, 34]
Epoch: 0, batch loss: 0.11882 Loss Sum: 120.79469, accuracy : 0.92308, val loss: 5.45802, val accuracy: 0.90774
[[730   2   0  11]
 [  1 157   0   4]
 [  1   0 241  14]
 [144   2  13 761]]
[[0.98250336 0.00269179 0.         0.01480485]
 [0.00617284 0.9691358  0.         0.02469136]
 [0.00390625 0.         0.94140625 0.0546875 ]
 [0.15652174 0.00217391 0.01413043 0.82717391]]
	 Final score: 0.9202926735554225 [('val/VGG16/normal/f1-score', 0.9017912291537987), ('val/VGG16/monotone/f1-score', 0.9721362229102167), ('val/VGG16/screenshot/f1-score', 0.9450980392156861), ('val/VGG16/unknown/f1-score', 0.8900584795321639)]
	 Time elapsed : 617.70755 _________________________________

Trying to save to /tmp/tmpnxuq9wgc/model_VGG16
Epoch: 1, batch loss: 0.00638 Loss Sum: 20.84869, accuracy : 0.99066, val loss: 6.66798, val accuracy: 0.91014
[[730   1   0  12]
 [  3 155   0   4]
 [  1   0 240  15]
 [138   1  12 769]]
[[0.98250336 0.0013459  0.         0.01615074]
 [0.01851852 0.95679012 0.         0.02469136]
 [0.00390625 0.         0.9375     0.05859375]
 [0.15       0.00108696 0.01304348 0.83586957]]
	 Final score: 0.9219286182247316 [('val/VGG16/normal/f1-score', 0.9040247678018576), ('val/VGG16/monotone/f1-score', 0.9717868338557994), ('val/VGG16/screenshot/f1-score', 0.9448818897637795), ('val/VGG16/unknown/f1-score', 0.8941860465116278)]
	 Time elapsed : 1228.56278 _________________________________

Trying to save to /tmp/tmphizkh2wr/model_VGG16
Epoch: 2, batch loss: 0.02080 Loss Sum: 5.69367, accuracy : 0.99835, val loss: 8.01981, val accuracy: 0.90726
[[733   0   0  10]
 [  3 157   0   2]
 [  1   0 241  14]
 [148   1  14 757]]
[[0.98654105 0.         0.         0.01345895]
 [0.01851852 0.9691358  0.         0.01234568]
 [0.00390625 0.         0.94140625 0.0546875 ]
 [0.16086957 0.00108696 0.01521739 0.82282609]]
	 Final score: 0.9214886346355247 [('val/VGG16/normal/f1-score', 0.9004914004914005), ('val/VGG16/monotone/f1-score', 0.9812500000000001), ('val/VGG16/screenshot/f1-score', 0.9432485322896281), ('val/VGG16/unknown/f1-score', 0.8890193775689958)]
	 Time elapsed : 1847.12689 _________________________________

Epoch: 3, batch loss: 0.00351 Loss Sum: 3.34005, accuracy : 0.99917, val loss: 8.98684, val accuracy: 0.89909
[[729   1   0  13]
 [  5 155   0   2]
 [  1   0 239  16]
 [160   1  11 748]]
[[0.98115747 0.0013459  0.         0.01749664]
 [0.0308642  0.95679012 0.         0.01234568]
 [0.00390625 0.         0.93359375 0.0625    ]
 [0.17391304 0.00108696 0.01195652 0.81304348]]
	 Final score: 0.9141305959621651 [('val/VGG16/normal/f1-score', 0.8901098901098901), ('val/VGG16/monotone/f1-score', 0.9717868338557994), ('val/VGG16/screenshot/f1-score', 0.9446640316205533), ('val/VGG16/unknown/f1-score', 0.8805179517363155)]
	 Time elapsed : 2460.28619 _________________________________

Epoch: 4, batch loss: 0.00499 Loss Sum: 2.19395, accuracy : 0.99948, val loss: 10.09652, val accuracy: 0.89620
[[732   1   0  10]
 [  6 154   0   2]
 [  2   0 240  14]
 [164   1  16 739]]
[[0.98519515 0.0013459  0.         0.01345895]
 [0.03703704 0.95061728 0.         0.01234568]
 [0.0078125  0.         0.9375     0.0546875 ]
 [0.17826087 0.00108696 0.0173913  0.80326087]]
	 Final score: 0.9101134080022666 [('val/VGG16/normal/f1-score', 0.888888888888889), ('val/VGG16/monotone/f1-score', 0.9685534591194969), ('val/VGG16/screenshot/f1-score', 0.9375), ('val/VGG16/unknown/f1-score', 0.8771513353115727)]
	 Time elapsed : 3076.07923 _________________________________

Early stopping!! 
Score too low -1
---train finished---
VGG16 Loaded!
{'batch_size': 128,
 'class_ratio': [0.6, 0.08, 0.1, 0.45],
 'epoch': [5, 10],
 'gamma': 0.3,
 'learning_rate': 0.001,
 'loss_cls_weight': tensor([1.0000, 1.0000, 1.0000, 1.1000]),
 'optimizer': 'Adam',
 'step_size': 5,
 'transforms': [1, None],
 'val_ratio': [0.012, 0.25, 0.2, 0.2],
 'weight_decay': 0}
Dataloader constructed! 
	 Train size = 80857 	Validation size = 2081
	 Validation dataset composition  [35, 7, 12, 44]
	 Training dataset composition  [39443, 5259, 6573, 29582]
	 Training dataset proportion  [48, 6, 8, 36]
Epoch: 0, batch loss: 0.25592 Loss Sum: 245.39247, accuracy : 0.86231, val loss: 7.38963, val accuracy: 0.86353
[[645   5   0  93]
 [  1 156   0   5]
 [  1   0 234  21]
 [111  14  33 762]]
[[0.86810229 0.00672948 0.         0.12516824]
 [0.00617284 0.96296296 0.         0.0308642 ]
 [0.00390625 0.         0.9140625  0.08203125]
 [0.12065217 0.01521739 0.03586957 0.82826087]]
	 Final score: 0.8709357670477191 [('val/VGG16/normal/f1-score', 0.8594270486342439), ('val/VGG16/monotone/f1-score', 0.9258160237388725), ('val/VGG16/screenshot/f1-score', 0.8948374760994264), ('val/VGG16/unknown/f1-score', 0.8461965574680733)]
	 Time elapsed : 724.48815 _________________________________

Epoch: 1, batch loss: 0.12854 Loss Sum: 102.78680, accuracy : 0.94835, val loss: 9.82756, val accuracy: 0.85103
[[722   0   0  21]
 [ 11 147   0   4]
 [  1   0 233  22]
 [222   1  28 669]]
[[0.9717362  0.         0.         0.0282638 ]
 [0.06790123 0.90740741 0.         0.02469136]
 [0.00390625 0.         0.91015625 0.0859375 ]
 [0.24130435 0.00108696 0.03043478 0.72717391]]
	 Final score: 0.8676486621045256 [('val/VGG16/normal/f1-score', 0.849911712772219), ('val/VGG16/monotone/f1-score', 0.9483870967741935), ('val/VGG16/screenshot/f1-score', 0.9013539651837524), ('val/VGG16/unknown/f1-score', 0.8178484107579462)]
	 Time elapsed : 1426.07134 _________________________________

Epoch: 2, batch loss: 0.02069 Loss Sum: 66.82631, accuracy : 0.97202, val loss: 10.04879, val accuracy: 0.86209
[[716   0   0  27]
 [ 11 142   0   9]
 [  0   0 227  29]
 [191   4  16 709]]
[[0.96366083 0.         0.         0.03633917]
 [0.06790123 0.87654321 0.         0.05555556]
 [0.         0.         0.88671875 0.11328125]
 [0.2076087  0.00434783 0.0173913  0.77065217]]
	 Final score: 0.8720905569551518 [('val/VGG16/normal/f1-score', 0.8621312462372065), ('val/VGG16/monotone/f1-score', 0.922077922077922), ('val/VGG16/screenshot/f1-score', 0.9098196392785571), ('val/VGG16/unknown/f1-score', 0.8370720188902008)]
	 Time elapsed : 2110.11563 _________________________________

Epoch: 3, batch loss: 0.08105 Loss Sum: 59.51260, accuracy : 0.97661, val loss: 12.35143, val accuracy: 0.84959
[[729   0   0  14]
 [ 12 145   0   5]
 [  0   0 236  20]
 [235   6  21 658]]
[[0.98115747 0.         0.         0.01884253]
 [0.07407407 0.89506173 0.         0.0308642 ]
 [0.         0.         0.921875   0.078125  ]
 [0.25543478 0.00652174 0.02282609 0.71521739]]
	 Final score: 0.865351386352354 [('val/VGG16/normal/f1-score', 0.8481675392670157), ('val/VGG16/monotone/f1-score', 0.9265175718849841), ('val/VGG16/screenshot/f1-score', 0.9200779727095517), ('val/VGG16/unknown/f1-score', 0.8138528138528139)]
	 Time elapsed : 2799.09206 _________________________________

Epoch: 4, batch loss: 0.03443 Loss Sum: 54.38341, accuracy : 0.97985, val loss: 12.04998, val accuracy: 0.84959
[[720   0   0  23]
 [ 13 145   0   4]
 [  0   0 229  27]
 [223   2  21 674]]
[[0.96904441 0.         0.         0.03095559]
 [0.08024691 0.89506173 0.         0.02469136]
 [0.         0.         0.89453125 0.10546875]
 [0.2423913  0.00217391 0.02282609 0.7326087 ]]
	 Final score: 0.865541858673786 [('val/VGG16/normal/f1-score', 0.8475573866980577), ('val/VGG16/monotone/f1-score', 0.9385113268608414), ('val/VGG16/screenshot/f1-score', 0.9051383399209487), ('val/VGG16/unknown/f1-score', 0.8179611650485438)]
	 Time elapsed : 3482.19825 _________________________________

Epoch: 5, batch loss: 0.23601 Loss Sum: 149.14902, accuracy : 0.91788, val loss: 6.20343, val accuracy: 0.89284
[[678   2   0  63]
 [  6 151   0   5]
 [  0   0 240  16]
 [107   5  19 789]]
[[0.91251682 0.00269179 0.         0.08479139]
 [0.03703704 0.93209877 0.         0.0308642 ]
 [0.         0.         0.9375     0.0625    ]
 [0.11630435 0.00543478 0.02065217 0.8576087 ]]
	 Final score: 0.9017138297919612 [('val/VGG16/normal/f1-score', 0.8839634941329855), ('val/VGG16/monotone/f1-score', 0.9437500000000001), ('val/VGG16/screenshot/f1-score', 0.9320388349514563), ('val/VGG16/unknown/f1-score', 0.8800892359174568)]
	 Time elapsed : 690.23118 _________________________________

Epoch: 6, batch loss: 0.04202 Loss Sum: 68.20834, accuracy : 0.96396, val loss: 8.71186, val accuracy: 0.89140
[[696   0   0  47]
 [  4 148   0  10]
 [  1   0 241  14]
 [120   2  28 770]]
[[0.93674293 0.         0.         0.06325707]
 [0.02469136 0.91358025 0.         0.0617284 ]
 [0.00390625 0.         0.94140625 0.0546875 ]
 [0.13043478 0.00217391 0.03043478 0.83695652]]
	 Final score: 0.8994158888690571 [('val/VGG16/normal/f1-score', 0.8900255754475704), ('val/VGG16/monotone/f1-score', 0.9487179487179487), ('val/VGG16/screenshot/f1-score', 0.9180952380952381), ('val/VGG16/unknown/f1-score', 0.8745031232254401)]
	 Time elapsed : 1378.50780 _________________________________

Epoch: 7, batch loss: 0.03012 Loss Sum: 38.25871, accuracy : 0.97984, val loss: 10.56400, val accuracy: 0.88515
[[723   0   0  20]
 [  7 150   0   5]
 [  1   0 239  16]
 [165   5  20 730]]
[[0.9730821  0.         0.         0.0269179 ]
 [0.04320988 0.92592593 0.         0.0308642 ]
 [0.00390625 0.         0.93359375 0.0625    ]
 [0.17934783 0.00543478 0.02173913 0.79347826]]
	 Final score: 0.8961980128894733 [('val/VGG16/normal/f1-score', 0.8822452715070166), ('val/VGG16/monotone/f1-score', 0.9463722397476341), ('val/VGG16/screenshot/f1-score', 0.9281553398058252), ('val/VGG16/unknown/f1-score', 0.8633944411590774)]
	 Time elapsed : 2072.70450 _________________________________

Epoch: 8, batch loss: 0.02568 Loss Sum: 30.44140, accuracy : 0.98458, val loss: 14.75360, val accuracy: 0.86305
[[734   1   0   8]
 [  8 149   0   5]
 [  1   0 241  14]
 [225   8  15 672]]
[[0.98788694 0.0013459  0.         0.01076716]
 [0.04938272 0.91975309 0.         0.0308642 ]
 [0.00390625 0.         0.94140625 0.0546875 ]
 [0.24456522 0.00869565 0.01630435 0.73043478]]
	 Final score: 0.879467084135632 [('val/VGG16/normal/f1-score', 0.857977790765634), ('val/VGG16/monotone/f1-score', 0.9312499999999999), ('val/VGG16/screenshot/f1-score', 0.94140625), ('val/VGG16/unknown/f1-score', 0.8301420630018529)]
	 Time elapsed : 2787.35112 _________________________________

Early stopping!! 
---train finished---
VGG16 Loaded!
{'batch_size': 128,
 'class_ratio': [0.6, 0.08, 0.1, 0.45],
 'epoch': [0, 15],
 'gamma': 0.3,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1.0000, 1.0000, 1.0000, 1.1000]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'val_ratio': [0.012, 0.25, 0.2, 0.2],
 'weight_decay': 0.001}
Dataloader constructed! 
	 Train size = 80857 	Validation size = 2081
	 Validation dataset composition  [35, 7, 12, 44]
	 Training dataset composition  [39443, 5259, 6573, 29582]
	 Training dataset proportion  [48, 6, 8, 36]
Epoch: 0, batch loss: 0.06121 Loss Sum: 93.43124, accuracy : 0.94724, val loss: 7.01309, val accuracy: 0.90101
[[727   0   0  16]
 [ 12 141   0   9]
 [  0   0 240  16]
 [140   1  12 767]]
[[0.97846568 0.         0.         0.02153432]
 [0.07407407 0.87037037 0.         0.05555556]
 [0.         0.         0.9375     0.0625    ]
 [0.15217391 0.00108696 0.01304348 0.83369565]]
	 Final score: 0.906423872209205 [('val/VGG16/normal/f1-score', 0.8964241676942047), ('val/VGG16/monotone/f1-score', 0.9276315789473684), ('val/VGG16/screenshot/f1-score', 0.9448818897637795), ('val/VGG16/unknown/f1-score', 0.8877314814814815)]
	 Time elapsed : 913.55761 _________________________________

Epoch: 1, batch loss: 0.02602 Loss Sum: 39.54505, accuracy : 0.97839, val loss: 5.61092, val accuracy: 0.91062
[[715   3   0  25]
 [  1 156   0   5]
 [  1   0 240  15]
 [107  11  18 784]]
[[0.96231494 0.00403769 0.         0.03364738]
 [0.00617284 0.96296296 0.         0.0308642 ]
 [0.00390625 0.         0.9375     0.05859375]
 [0.11630435 0.01195652 0.01956522 0.85217391]]
	 Final score: 0.9136070292050313 [('val/VGG16/normal/f1-score', 0.9125717932354818), ('val/VGG16/monotone/f1-score', 0.9397590361445782), ('val/VGG16/screenshot/f1-score', 0.933852140077821), ('val/VGG16/unknown/f1-score', 0.8965122927387079)]
	 Time elapsed : 1835.49495 _________________________________

Epoch: 2, batch loss: 0.00100 Loss Sum: 9.20371, accuracy : 0.99576, val loss: 11.95791, val accuracy: 0.89284
[[736   0   0   7]
 [  4 154   0   4]
 [  1   0 239  16]
 [177   5   9 729]]
[[0.99057873 0.         0.         0.00942127]
 [0.02469136 0.95061728 0.         0.02469136]
 [0.00390625 0.         0.93359375 0.0625    ]
 [0.1923913  0.00543478 0.00978261 0.7923913 ]]
	 Final score: 0.907857433780019 [('val/VGG16/normal/f1-score', 0.8862131246237206), ('val/VGG16/monotone/f1-score', 0.9595015576323987), ('val/VGG16/screenshot/f1-score', 0.9484126984126984), ('val/VGG16/unknown/f1-score', 0.869928400954654)]
	 Time elapsed : 2753.79522 _________________________________

Epoch: 3, batch loss: 0.00137 Loss Sum: 4.98745, accuracy : 0.99790, val loss: 9.81823, val accuracy: 0.90245
[[727   0   0  16]
 [  9 148   0   5]
 [  1   0 242  13]
 [141   3  15 761]]
[[0.97846568 0.         0.         0.02153432]
 [0.05555556 0.91358025 0.         0.0308642 ]
 [0.00390625 0.         0.9453125  0.05078125]
 [0.15326087 0.00326087 0.01630435 0.82717391]]
	 Final score: 0.9109084176718015 [('val/VGG16/normal/f1-score', 0.8969771745835904), ('val/VGG16/monotone/f1-score', 0.9456869009584664), ('val/VGG16/screenshot/f1-score', 0.9434697855750488), ('val/VGG16/unknown/f1-score', 0.887463556851312)]
	 Time elapsed : 3671.95212 _________________________________

Epoch: 4, batch loss: 0.00014 Loss Sum: 1.85237, accuracy : 0.99931, val loss: 12.63784, val accuracy: 0.89861
[[730   0   0  13]
 [  7 152   0   3]
 [  1   0 240  15]
 [156   5  11 748]]
[[0.98250336 0.         0.         0.01749664]
 [0.04320988 0.9382716  0.         0.01851852]
 [0.00390625 0.         0.9375     0.05859375]
 [0.16956522 0.00543478 0.01195652 0.81304348]]
	 Final score: 0.9103087155483169 [('val/VGG16/normal/f1-score', 0.8918753817959683), ('val/VGG16/monotone/f1-score', 0.9529780564263323), ('val/VGG16/screenshot/f1-score', 0.9467455621301776), ('val/VGG16/unknown/f1-score', 0.8805179517363155)]
	 Time elapsed : 4593.54630 _________________________________

Early stopping!! 
---train finished---
VGG16 Loaded!
{'batch_size': 128,
 'class_ratio': [0.5, 0.1, 0.15, 0.4],
 'epoch': [0, 15],
 'gamma': 0.1,
 'learning_rate': 0.001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [2,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'val_ratio': [0.012, 0.25, 0.2, 0.2],
 'weight_decay': 0}
Dataloader constructed! 
	 Train size = 75597 	Validation size = 2081
	 Validation dataset composition  [35, 7, 12, 44]
	 Training dataset composition  [32869, 6573, 9860, 26295]
	 Training dataset proportion  [43, 8, 13, 34]
Epoch: 0, batch loss: 1.25608 Loss Sum: 735.40692, accuracy : 0.44157, val loss: 20.67644, val accuracy: 0.35704
[[743   0   0   0]
 [162   0   0   0]
 [256   0   0   0]
 [920   0   0   0]]
[[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
	 Final score: 0.0 [('val/VGG16/normal/f1-score', 0.5262039660056657), ('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.0), ('val/VGG16/unknown/f1-score', 0.0)]
	 Time elapsed : 802.32699 _________________________________

---train finished---
VGG16 Loaded!
{'batch_size': 128,
 'class_ratio': [0.5, 0.1, 0.15, 0.4],
 'epoch': [5, 10],
 'gamma': 0.1,
 'learning_rate': 0.0001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 5,
 'transforms': [2,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'val_ratio': [0.012, 0.25, 0.2, 0.2],
 'weight_decay': 0.001}
Dataloader constructed! 
	 Train size = 75597 	Validation size = 2081
	 Validation dataset composition  [35, 7, 12, 44]
	 Training dataset composition  [32869, 6573, 9860, 26295]
	 Training dataset proportion  [43, 8, 13, 34]
Epoch: 0, batch loss: 0.03416 Loss Sum: 73.15017, accuracy : 0.95512, val loss: 6.22478, val accuracy: 0.91350
[[726   1   0  16]
 [  3 158   0   1]
 [  1   0 238  17]
 [123   1  17 779]]
[[0.97711978 0.0013459  0.         0.02153432]
 [0.01851852 0.97530864 0.         0.00617284]
 [0.00390625 0.         0.9296875  0.06640625]
 [0.13369565 0.00108696 0.01847826 0.84673913]]
	 Final score: 0.9237617344202148 [('val/VGG16/normal/f1-score', 0.9097744360902256), ('val/VGG16/monotone/f1-score', 0.9813664596273292), ('val/VGG16/screenshot/f1-score', 0.9315068493150684), ('val/VGG16/unknown/f1-score', 0.8990190421234853)]
	 Time elapsed : 807.90613 _________________________________

Trying to save to /tmp/tmpf0ddcmt8/model_VGG16
Epoch: 1, batch loss: 0.00702 Loss Sum: 18.34438, accuracy : 0.98985, val loss: 6.36171, val accuracy: 0.92263
[[729   0   0  14]
 [  4 155   0   3]
 [  0   0 235  21]
 [108   1  10 801]]
[[0.98115747 0.         0.         0.01884253]
 [0.02469136 0.95679012 0.         0.01851852]
 [0.         0.         0.91796875 0.08203125]
 [0.1173913  0.00108696 0.01086957 0.87065217]]
	 Final score: 0.9300912556874015 [('val/VGG16/normal/f1-score', 0.9204545454545455), ('val/VGG16/monotone/f1-score', 0.9748427672955975), ('val/VGG16/screenshot/f1-score', 0.93812375249501), ('val/VGG16/unknown/f1-score', 0.9107447413303013)]
	 Time elapsed : 1622.75520 _________________________________

Trying to save to /tmp/tmpott6sy3y/model_VGG16
Epoch: 2, batch loss: 0.01066 Loss Sum: 13.69809, accuracy : 0.99224, val loss: 9.62612, val accuracy: 0.89092
[[734   0   0   9]
 [  7 148   0   7]
 [  2   0 241  13]
 [171   1  17 731]]
[[0.98788694 0.         0.         0.01211306]
 [0.04320988 0.91358025 0.         0.04320988]
/opt/conda/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
 [0.0078125  0.         0.94140625 0.05078125]
 [0.18586957 0.00108696 0.01847826 0.79456522]]
	 Final score: 0.9030766295670521 [('val/VGG16/normal/f1-score', 0.8859384429692214), ('val/VGG16/monotone/f1-score', 0.9517684887459807), ('val/VGG16/screenshot/f1-score', 0.9377431906614787), ('val/VGG16/unknown/f1-score', 0.8702380952380954)]
	 Time elapsed : 2442.32469 _________________________________

Epoch: 3, batch loss: 0.00394 Loss Sum: 9.52343, accuracy : 0.99485, val loss: 7.44149, val accuracy: 0.91062
[[724   1   0  18]
 [  4 157   0   1]
 [  1   0 235  20]
 [125   1  15 779]]
[[0.97442799 0.0013459  0.         0.02422611]
 [0.02469136 0.9691358  0.         0.00617284]
 [0.00390625 0.         0.91796875 0.078125  ]
 [0.13586957 0.00108696 0.01630435 0.84673913]]
	 Final score: 0.9206538001121292 [('val/VGG16/normal/f1-score', 0.9067000626174078), ('val/VGG16/monotone/f1-score', 0.9781931464174456), ('val/VGG16/screenshot/f1-score', 0.9288537549407114), ('val/VGG16/unknown/f1-score', 0.8964326812428078)]
	 Time elapsed : 3251.03126 _________________________________

Epoch: 4, batch loss: 0.00270 Loss Sum: 10.31855, accuracy : 0.99430, val loss: 8.52937, val accuracy: 0.91158
[[730   0   0  13]
 [  4 155   0   3]
 [  0   0 244  12]
 [131   1  20 768]]
[[0.98250336 0.         0.         0.01749664]
 [0.02469136 0.95679012 0.         0.01851852]
 [0.         0.         0.953125   0.046875  ]
 [0.1423913  0.00108696 0.02173913 0.83478261]]
	 Final score: 0.9223542696401134 [('val/VGG16/normal/f1-score', 0.9079601990049753), ('val/VGG16/monotone/f1-score', 0.9748427672955975), ('val/VGG16/screenshot/f1-score', 0.9384615384615383), ('val/VGG16/unknown/f1-score', 0.8951048951048952)]
	 Time elapsed : 4057.14968 _________________________________

Early stopping!! 
Score too low -1
---train finished---
VGG16 Loaded!
{'batch_size': 128,
 'class_ratio': [0.6, 0.08, 0.1, 0.45],
 'epoch': [0, 15],
 'gamma': 0.3,
 'learning_rate': 0.001,
 'loss_cls_weight': tensor([1.0000, 1.0000, 1.0000, 1.1000]),
 'optimizer': 'Adam',
 'step_size': 5,
 'transforms': [2,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'val_ratio': [0.012, 0.25, 0.2, 0.2],
 'weight_decay': 0}
Dataloader constructed! 
	 Train size = 80857 	Validation size = 2081
	 Validation dataset composition  [35, 7, 12, 44]
	 Training dataset composition  [39443, 5259, 6573, 29582]
	 Training dataset proportion  [48, 6, 8, 36]
Epoch: 0, batch loss: 0.31501 Loss Sum: 284.00749, accuracy : 0.82887, val loss: 5.26226, val accuracy: 0.88996
[[694   1   0  48]
 [  5 153   0   4]
 [  0   0 245  11]
 [129   6  25 760]]
[[0.93405114 0.0013459  0.         0.06460296]
 [0.0308642  0.94444444 0.         0.02469136]
 [0.         0.         0.95703125 0.04296875]
 [0.14021739 0.00652174 0.02717391 0.82608696]]
	 Final score: 0.9009120054972471 [('val/VGG16/normal/f1-score', 0.8835136855506046), ('val/VGG16/monotone/f1-score', 0.9503105590062112), ('val/VGG16/screenshot/f1-score', 0.9315589353612167), ('val/VGG16/unknown/f1-score', 0.8720596672403902)]
	 Time elapsed : 898.19866 _________________________________

Epoch: 1, batch loss: 0.35099 Loss Sum: 167.17226, accuracy : 0.90672, val loss: 5.60308, val accuracy: 0.88852
[[687   2   0  54]
 [  6 151   0   5]
 [  0   0 235  21]
 [123   8  13 776]]
[[0.92462988 0.00269179 0.         0.07267833]
 [0.03703704 0.93209877 0.         0.0308642 ]
 [0.         0.         0.91796875 0.08203125]
 [0.13369565 0.00869565 0.01413043 0.84347826]]
	 Final score: 0.8970875915362344 [('val/VGG16/normal/f1-score', 0.8813341885824246), ('val/VGG16/monotone/f1-score', 0.934984520123839), ('val/VGG16/screenshot/f1-score', 0.9325396825396824), ('val/VGG16/unknown/f1-score', 0.8738738738738738)]
	 Time elapsed : 1801.85515 _________________________________

Epoch: 2, batch loss: 0.25792 Loss Sum: 144.32771, accuracy : 0.91918, val loss: 6.08591, val accuracy: 0.88419
[[718   3   0  22]
 [  5 154   0   3]
 [  0   0 239  17]
 [159  12  20 729]]
[[0.96635262 0.00403769 0.         0.02960969]
 [0.0308642  0.95061728 0.         0.01851852]
 [0.         0.         0.93359375 0.06640625]
 [0.17282609 0.01304348 0.02173913 0.7923913 ]]
	 Final score: 0.8921422435167692 [('val/VGG16/normal/f1-score', 0.8836923076923076), ('val/VGG16/monotone/f1-score', 0.9305135951661632), ('val/VGG16/screenshot/f1-score', 0.9281553398058252), ('val/VGG16/unknown/f1-score', 0.8622117090479007)]
	 Time elapsed : 2701.47975 _________________________________

Epoch: 3, batch loss: 0.27393 Loss Sum: 128.02993, accuracy : 0.92802, val loss: 7.22401, val accuracy: 0.88563
[[706   0   0  37]
 [ 17 139   0   6]
 [  0   0 227  29]
 [133   5  11 771]]
[[0.95020188 0.         0.         0.04979812]
 [0.10493827 0.85802469 0.         0.03703704]
 [0.         0.         0.88671875 0.11328125]
 [0.14456522 0.00543478 0.01195652 0.83804348]]
	 Final score: 0.8872324705829322 [('val/VGG16/normal/f1-score', 0.8830519074421513), ('val/VGG16/monotone/f1-score', 0.9084967320261438), ('val/VGG16/screenshot/f1-score', 0.9190283400809717), ('val/VGG16/unknown/f1-score', 0.8746454906409529)]
	 Time elapsed : 3596.80966 _________________________________

Early stopping!! 
---train finished---
VGG16 Loaded!
{'batch_size': 128,
 'class_ratio': [0.5, 0.1, 0.15, 0.4],
 'epoch': [5, 10],
 'gamma': 0.3,
 'learning_rate': 0.001,
 'loss_cls_weight': tensor([1.0000, 1.0000, 1.0000, 1.1000]),
 'optimizer': 'Adam',
 'step_size': 5,
 'transforms': [2,
                Compose(
    ColorJitter(brightness=None, contrast=None, saturation=[0.95, 1.05], hue=[-0.05, 0.05])
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)],
 'val_ratio': [0.012, 0.25, 0.2, 0.2],
 'weight_decay': 0.001}
Dataloader constructed! 
	 Train size = 75597 	Validation size = 2081
	 Validation dataset composition  [35, 7, 12, 44]
	 Training dataset composition  [32869, 6573, 9860, 26295]
	 Training dataset proportion  [43, 8, 13, 34]
Epoch: 0, batch loss: 0.22328 Loss Sum: 255.16909, accuracy : 0.85599, val loss: 5.02250, val accuracy: 0.91014
[[705   2   0  36]
 [  2 157   0   3]
 [  0   0 233  23]
 [100  10  11 799]]
[[0.94885599 0.00269179 0.         0.04845222]
 [0.01234568 0.9691358  0.         0.01851852]
 [0.         0.         0.91015625 0.08984375]
 [0.10869565 0.01086957 0.01195652 0.86847826]]
	 Final score: 0.9148700491971562 [('val/VGG16/normal/f1-score', 0.9096774193548387), ('val/VGG16/monotone/f1-score', 0.9486404833836858), ('val/VGG16/screenshot/f1-score', 0.9319999999999999), ('val/VGG16/unknown/f1-score', 0.8972487366647951)]
	 Time elapsed : 784.67239 _________________________________

Epoch: 1, batch loss: 0.12181 Loss Sum: 93.22230, accuracy : 0.94472, val loss: 5.18098, val accuracy: 0.90870
[[717   1   0  25]
 [  4 153   0   5]
 [  1   0 245  10]
 [117   5  22 776]]
[[0.96500673 0.0013459  0.         0.03364738]
 [0.02469136 0.94444444 0.         0.0308642 ]
 [0.00390625 0.         0.95703125 0.0390625 ]
 [0.12717391 0.00543478 0.02391304 0.84347826]]
	 Final score: 0.9156043576497404 [('val/VGG16/normal/f1-score', 0.9064475347661187), ('val/VGG16/monotone/f1-score', 0.9532710280373832), ('val/VGG16/screenshot/f1-score', 0.9369024856596558), ('val/VGG16/unknown/f1-score', 0.8940092165898618)]
	 Time elapsed : 1569.47395 _________________________________

Epoch: 2, batch loss: 0.14775 Loss Sum: 70.79861, accuracy : 0.95788, val loss: 5.68466, val accuracy: 0.90870
[[712   0   0  31]
 [ 11 143   0   8]
 [  0   0 237  19]
 [ 98   2  21 799]]
[[0.95827725 0.         0.         0.04172275]
 [0.06790123 0.88271605 0.         0.04938272]
 [0.         0.         0.92578125 0.07421875]
 [0.10652174 0.00217391 0.02282609 0.86847826]]
	 Final score: 0.908508016981086 [('val/VGG16/normal/f1-score', 0.9104859335038364), ('val/VGG16/monotone/f1-score', 0.9315960912052118), ('val/VGG16/screenshot/f1-score', 0.9221789883268482), ('val/VGG16/unknown/f1-score', 0.899268429938098)]
	 Time elapsed : 2355.85661 _________________________________

Epoch: 3, batch loss: 0.08733 Loss Sum: 57.74270, accuracy : 0.96656, val loss: 8.58129, val accuracy: 0.89909
[[732   0   0  11]
 [  7 149   0   6]
 [  1   0 245  10]
 [148   1  26 745]]
[[0.98519515 0.         0.         0.01480485]
 [0.04320988 0.91975309 0.         0.03703704]
 [0.00390625 0.         0.95703125 0.0390625 ]
 [0.16086957 0.00108696 0.02826087 0.80978261]]
	 Final score: 0.9080030690441726 [('val/VGG16/normal/f1-score', 0.897608828939301), ('val/VGG16/monotone/f1-score', 0.9551282051282051), ('val/VGG16/screenshot/f1-score', 0.9297912713472486), ('val/VGG16/unknown/f1-score', 0.8806146572104019)]
	 Time elapsed : 3139.05097 _________________________________

Epoch: 4, batch loss: 0.04723 Loss Sum: 50.70115, accuracy : 0.97196, val loss: 6.34306, val accuracy: 0.91927
[[707   1   1  34]
 [  2 156   0   4]
 [  0   0 241  15]
 [ 86   3  22 809]]
[[0.95154778 0.0013459  0.0013459  0.04576043]
 [0.01234568 0.96296296 0.         0.02469136]
 [0.         0.         0.94140625 0.05859375]
 [0.09347826 0.00326087 0.02391304 0.87934783]]
	 Final score: 0.924450238182049 [('val/VGG16/normal/f1-score', 0.9193758127438231), ('val/VGG16/monotone/f1-score', 0.9689440993788819), ('val/VGG16/screenshot/f1-score', 0.926923076923077), ('val/VGG16/unknown/f1-score', 0.9079685746352413)]
	 Time elapsed : 3920.14070 _________________________________

Epoch: 5, batch loss: 0.17445 Loss Sum: 158.07508, accuracy : 0.91054, val loss: 4.50889, val accuracy: 0.90870
[[705   0   0  38]
 [  7 152   0   3]
 [  1   0 244  11]
 [103   3  24 790]]
[[0.94885599 0.         0.         0.05114401]
 [0.04320988 0.9382716  0.         0.01851852]
 [0.00390625 0.         0.953125   0.04296875]
 [0.11195652 0.00326087 0.02608696 0.85869565]]
	 Final score: 0.9157950309702374 [('val/VGG16/normal/f1-score', 0.9044259140474663), ('val/VGG16/monotone/f1-score', 0.9589905362776024), ('val/VGG16/screenshot/f1-score', 0.931297709923664), ('val/VGG16/unknown/f1-score', 0.8967082860385925)]
	 Time elapsed : 781.84684 _________________________________

Epoch: 6, batch loss: 0.09325 Loss Sum: 88.14180, accuracy : 0.94800, val loss: 4.35977, val accuracy: 0.92119
[[703   1   0  39]
 [  2 158   0   2]
 [  1   0 231  24]
 [ 78   4  13 825]]
[[0.9461642  0.0013459  0.         0.05248991]
 [0.01234568 0.97530864 0.         0.01234568]
 [0.00390625 0.         0.90234375 0.09375   ]
 [0.08478261 0.00434783 0.01413043 0.89673913]]
	 Final score: 0.9259149456549863 [('val/VGG16/normal/f1-score', 0.9207596594629992), ('val/VGG16/monotone/f1-score', 0.9723076923076923), ('val/VGG16/screenshot/f1-score', 0.9239999999999999), ('val/VGG16/unknown/f1-score', 0.9116022099447514)]
	 Time elapsed : 1561.06348 _________________________________

Epoch: 7, batch loss: 0.08562 Loss Sum: 76.55471, accuracy : 0.95505, val loss: 5.67706, val accuracy: 0.90389
[[720   0   0  23]
 [  6 152   0   4]
 [  1   0 241  14]
 [130   1  21 768]]
[[0.96904441 0.         0.         0.03095559]
 [0.03703704 0.9382716  0.         0.02469136]
 [0.00390625 0.         0.94140625 0.0546875 ]
 [0.14130435 0.00108696 0.02282609 0.83478261]]
	 Final score: 0.9136076727023984 [('val/VGG16/normal/f1-score', 0.8999999999999999), ('val/VGG16/monotone/f1-score', 0.9650793650793651), ('val/VGG16/screenshot/f1-score', 0.9305019305019306), ('val/VGG16/unknown/f1-score', 0.8883747831116251)]
	 Time elapsed : 2337.51563 _________________________________

Epoch: 8, batch loss: 0.12466 Loss Sum: 65.49566, accuracy : 0.96091, val loss: 5.23631, val accuracy: 0.91543
[[711   2   0  30]
 [  3 156   0   3]
 [  1   0 236  19]
 [108   4   6 802]]
[[0.95693136 0.00269179 0.         0.04037685]
 [0.01851852 0.96296296 0.         0.01851852]
 [0.00390625 0.         0.921875   0.07421875]
 [0.1173913  0.00434783 0.00652174 0.87173913]]
	 Final score: 0.9243193476221724 [('val/VGG16/normal/f1-score', 0.9080459770114944), ('val/VGG16/monotone/f1-score', 0.9629629629629629), ('val/VGG16/screenshot/f1-score', 0.9477911646586346), ('val/VGG16/unknown/f1-score', 0.9041713641488163)]
	 Time elapsed : 3113.40191 _________________________________

Epoch: 9, batch loss: 0.07679 Loss Sum: 65.47756, accuracy : 0.96067, val loss: 4.44689, val accuracy: 0.91591
[[693   1   0  49]
 [  2 158   0   2]
 [  0   0 235  21]
 [ 90   3   7 820]]
[[0.93270525 0.0013459  0.         0.06594886]
 [0.01234568 0.97530864 0.         0.01234568]
 [0.         0.         0.91796875 0.08203125]
 [0.09782609 0.00326087 0.0076087  0.89130435]]
	 Final score: 0.9264435058549543 [('val/VGG16/normal/f1-score', 0.9070680628272252), ('val/VGG16/monotone/f1-score', 0.9753086419753086), ('val/VGG16/screenshot/f1-score', 0.9437751004016064), ('val/VGG16/unknown/f1-score', 0.9050772626931567)]
	 Time elapsed : 3892.77366 _________________________________

Epoch: 10, batch loss: 0.07755 Loss Sum: 27.81606, accuracy : 0.98540, val loss: 5.57912, val accuracy: 0.92648
[[709   0   0  34]
 [  4 155   0   3]
 [  1   0 242  13]
 [ 88   1   9 822]]
[[0.95423957 0.         0.         0.04576043]
 [0.02469136 0.95679012 0.         0.01851852]
 [0.00390625 0.         0.9453125  0.05078125]
 [0.09565217 0.00108696 0.00978261 0.89347826]]
	 Final score: 0.9356505782012194 [('val/VGG16/normal/f1-score', 0.917799352750809), ('val/VGG16/monotone/f1-score', 0.9748427672955975), ('val/VGG16/screenshot/f1-score', 0.9546351084812623), ('val/VGG16/unknown/f1-score', 0.9174107142857143)]
	 Time elapsed : 4660.07560 _________________________________

Trying to save to /tmp/tmpl1_eec9e/model_VGG16
Epoch: 11, batch loss: 0.02415 Loss Sum: 22.38983, accuracy : 0.98811, val loss: 8.56459, val accuracy: 0.90437
[[733   1   0   9]
 [  3 157   0   2]
 [  2   0 238  16]
 [154   3   9 754]]
[[0.98654105 0.0013459  0.         0.01211306]
 [0.01851852 0.9691358  0.         0.01234568]
 [0.0078125  0.         0.9296875  0.0625    ]
 [0.1673913  0.00326087 0.00978261 0.81956522]]
	 Final score: 0.9181861290369105 [('val/VGG16/normal/f1-score', 0.8966360856269113), ('val/VGG16/monotone/f1-score', 0.9721362229102167), ('val/VGG16/screenshot/f1-score', 0.9463220675944334), ('val/VGG16/unknown/f1-score', 0.8865373309817755)]
	 Time elapsed : 5419.53285 _________________________________

Epoch: 12, batch loss: 0.01127 Loss Sum: 22.27958, accuracy : 0.98802, val loss: 6.46360, val accuracy: 0.91254
[[713   1   0  29]
 [  2 153   0   7]
 [  1   0 241  14]
 [113   1  14 792]]
[[0.95962315 0.0013459  0.         0.03903096]
 [0.01234568 0.94444444 0.         0.04320988]
 [0.00390625 0.         0.94140625 0.0546875 ]
 [0.12282609 0.00108696 0.01521739 0.86086957]]
	 Final score: 0.9220141944699981 [('val/VGG16/normal/f1-score', 0.9071246819338422), ('val/VGG16/monotone/f1-score', 0.9652996845425867), ('val/VGG16/screenshot/f1-score', 0.9432485322896281), ('val/VGG16/unknown/f1-score', 0.898978433598184)]
	 Time elapsed : 6175.45529 _________________________________

Epoch: 13, batch loss: 0.04922 Loss Sum: 21.16060, accuracy : 0.98854, val loss: 8.64415, val accuracy: 0.90437
[[735   0   0   8]
 [  6 153   0   3]
 [  1   0 245  10]
 [150   2  19 749]]
[[0.98923284 0.         0.         0.01076716]
 [0.03703704 0.94444444 0.         0.01851852]
 [0.00390625 0.         0.95703125 0.0390625 ]
 [0.16304348 0.00217391 0.02065217 0.81413043]]
	 Final score: 0.9159978047674434 [('val/VGG16/normal/f1-score', 0.8990825688073395), ('val/VGG16/monotone/f1-score', 0.9652996845425867), ('val/VGG16/screenshot/f1-score', 0.9423076923076923), ('val/VGG16/unknown/f1-score', 0.8863905325443788)]
	 Time elapsed : 6935.03670 _________________________________

Early stopping!! 
---train finished---
VGG16 Loaded!
{'batch_size': 128,
 'class_ratio': [0.6, 0.08, 0.1, 0.45],
 'epoch': [0, 15],
 'gamma': 0.3,
 'learning_rate': 1e-05,
 'loss_cls_weight': tensor([1.0000, 1.0000, 1.0000, 1.1000]),
 'optimizer': 'Adam',
 'step_size': 5,
 'transforms': [1, None],
 'val_ratio': [0.012, 0.25, 0.2, 0.2],
 'weight_decay': 0}
Dataloader constructed! 
	 Train size = 80857 	Validation size = 2081
	 Validation dataset composition  [35, 7, 12, 44]
	 Training dataset composition  [39443, 5259, 6573, 29582]
	 Training dataset proportion  [48, 6, 8, 36]
Epoch: 0, batch loss: 0.03000 Loss Sum: 101.45518, accuracy : 0.93898, val loss: 7.04476, val accuracy: 0.89909
[[728   0   0  15]
 [  3 157   0   2]
 [  0   0 241  15]
 [155   5  15 745]]
[[0.97981157 0.         0.         0.02018843]
 [0.01851852 0.9691358  0.         0.01234568]
 [0.         0.         0.94140625 0.05859375]
 [0.16847826 0.00543478 0.01630435 0.80978261]]
	 Final score: 0.9129122334799784 [('val/VGG16/normal/f1-score', 0.8937998772252916), ('val/VGG16/monotone/f1-score', 0.9691358024691359), ('val/VGG16/screenshot/f1-score', 0.94140625), ('val/VGG16/unknown/f1-score', 0.8780200353565115)]
	 Time elapsed : 663.46822 _________________________________

Epoch: 1, batch loss: 0.00788 Loss Sum: 12.45686, accuracy : 0.99461, val loss: 16.23515, val accuracy: 0.86353
[[737   0   0   6]
 [  5 156   0   1]
 [  1   0 238  17]
 [238   6  10 666]]
[[0.99192463 0.         0.         0.00807537]
 [0.0308642  0.96296296 0.         0.00617284]
 [0.00390625 0.         0.9296875  0.06640625]
 [0.25869565 0.00652174 0.01086957 0.72391304]]
	 Final score: 0.8866498719962961 [('val/VGG16/normal/f1-score', 0.8549883990719258), ('val/VGG16/monotone/f1-score', 0.9629629629629629), ('val/VGG16/screenshot/f1-score', 0.9444444444444444), ('val/VGG16/unknown/f1-score', 0.827329192546584)]
	 Time elapsed : 1322.49941 _________________________________

Epoch: 2, batch loss: 0.00099 Loss Sum: 3.61820, accuracy : 0.99840, val loss: 13.81732, val accuracy: 0.89284
[[735   0   0   8]
 [  6 154   0   2]
 [  1   0 237  18]
 [174   5   9 732]]
[[0.98923284 0.         0.         0.01076716]
 [0.03703704 0.95061728 0.         0.01234568]
 [0.00390625 0.         0.92578125 0.0703125 ]
 [0.18913043 0.00543478 0.00978261 0.79565217]]
	 Final score: 0.9071498106930879 [('val/VGG16/normal/f1-score', 0.8860759493670887), ('val/VGG16/monotone/f1-score', 0.9595015576323987), ('val/VGG16/screenshot/f1-score', 0.944223107569721), ('val/VGG16/unknown/f1-score', 0.8714285714285714)]
	 Time elapsed : 1983.99213 _________________________________

Epoch: 3, batch loss: 0.00036 Loss Sum: 2.47772, accuracy : 0.99885, val loss: 14.21740, val accuracy: 0.89284
[[733   0   0  10]
 [  6 153   0   3]
 [  1   0 239  16]
 [169   5  13 733]]
[[0.98654105 0.         0.         0.01345895]
 [0.03703704 0.94444444 0.         0.01851852]
 [0.00390625 0.         0.93359375 0.0625    ]
 [0.18369565 0.00543478 0.01413043 0.79673913]]
	 Final score: 0.9058658219789619 [('val/VGG16/normal/f1-score', 0.8874092009685229), ('val/VGG16/monotone/f1-score', 0.9562499999999999), ('val/VGG16/screenshot/f1-score', 0.9409448818897638), ('val/VGG16/unknown/f1-score', 0.8715814506539833)]
	 Time elapsed : 2642.43897 _________________________________

Early stopping!! 
---train finished---
VGG16 Loaded!
{'batch_size': 128,
 'class_ratio': [0.6, 0.08, 0.1, 0.45],
 'epoch': [5, 10],
 'gamma': 0.3,
 'learning_rate': 0.001,
 'loss_cls_weight': tensor([1., 1., 1., 1.]),
 'optimizer': 'Adam',
 'step_size': 2,
 'transforms': [1, None],
 'val_ratio': [0.012, 0.25, 0.2, 0.2],
 'weight_decay': 0}
Dataloader constructed! 
	 Train size = 80857 	Validation size = 2081
	 Validation dataset composition  [35, 7, 12, 44]
	 Training dataset composition  [39443, 5259, 6573, 29582]
	 Training dataset proportion  [48, 6, 8, 36]
Epoch: 0, batch loss: 1.07621 Loss Sum: 705.86791, accuracy : 0.49209, val loss: 21.05523, val accuracy: 0.35704
[[743   0   0   0]
 [162   0   0   0]
 [256   0   0   0]
 [920   0   0   0]]
[[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
	 Final score: 0.0 [('val/VGG16/normal/f1-score', 0.5262039660056657), ('val/VGG16/monotone/f1-score', 0.0), ('val/VGG16/screenshot/f1-score', 0.0), ('val/VGG16/unknown/f1-score', 0.0)]
	 Time elapsed : 660.09209 _________________________________

Score too low 0.0
---train finished---